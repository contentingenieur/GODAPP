---
interface Props {
  title: string;
  youtubeId: string;
  description?: string;
  audiences?: string[];
}

const { title, youtubeId, description, audiences = ['all'] } = Astro.props;
const thumbnailUrl = `https://img.youtube.com/vi/${youtubeId}/maxresdefault.jpg`;
---

<div class="video-card card" data-audiences={audiences.join(',')}>
  <div class="video-thumbnail">
    <a
      href={`https://www.youtube.com/watch?v=${youtubeId}`}
      target="_blank"
      rel="noopener noreferrer"
      class="video-link"
    >
      <img
        src={thumbnailUrl}
        alt={`Video thumbnail for ${title}`}
        loading="lazy"
        onerror="this.src='https://img.youtube.com/vi/${youtubeId}/hqdefault.jpg'"
      />
      <div class="play-button">
        <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
          <circle cx="24" cy="24" r="24" fill="rgba(0,0,0,0.7)"/>
          <polygon points="20,16 34,24 20,32" fill="white"/>
        </svg>
      </div>
    </a>
  </div>
  <div class="video-info">
    <h4 class="video-title">
      <a
        href={`https://www.youtube.com/watch?v=${youtubeId}`}
        target="_blank"
        rel="noopener noreferrer"
      >
        {title}
      </a>
    </h4>
    {description && <p class="video-description">{description}</p>}
  </div>
  {audiences.length > 0 && !audiences.includes('all') && (
    <div class="video-audiences">
      {audiences.map(aud => (
        <span class={`audience-tag audience-${aud}`}>
          {aud.replace('-', ' ')}
        </span>
      ))}
    </div>
  )}
</div>

<style>
  .video-card {
    overflow: hidden;
    padding: 0;
  }

  .video-thumbnail {
    position: relative;
    aspect-ratio: 16 / 9;
    overflow: hidden;
    background-color: var(--color-border);
  }

  .video-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-base);
  }

  .video-link {
    display: block;
    width: 100%;
    height: 100%;
  }

  .video-link:hover img {
    transform: scale(1.05);
  }

  .play-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    transition: transform var(--transition-fast);
  }

  .video-link:hover .play-button {
    transform: translate(-50%, -50%) scale(1.1);
  }

  .video-info {
    padding: var(--space-4);
  }

  .video-title {
    font-family: var(--font-heading);
    font-size: var(--text-base);
    font-weight: 600;
    margin: 0 0 var(--space-2) 0;
  }

  .video-title a {
    color: var(--color-text);
  }

  .video-title a:hover {
    color: var(--color-accent);
  }

  .video-description {
    font-size: var(--text-sm);
    color: var(--color-text-light);
    margin: 0;
    line-height: 1.5;
  }

  .video-audiences {
    padding: 0 var(--space-4) var(--space-4);
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
  }
</style>
